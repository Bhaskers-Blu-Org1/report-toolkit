---
title: "observable"
---

[report-toolkit API](../home.mdx) › [Globals](../home) › [@report-toolkit/core](report_toolkit_core.mdx) › [observable](report_toolkit_core.observable.mdx)

[RxJS](https://rxjs.dev) `Observable`-based API. Used interally, but can also be used by consumers.

## Index

### Type aliases

- [Config](report_toolkit_core.observable.mdx#config)
- [DiffOptions](report_toolkit_core.observable.mdx#diffoptions)
- [DiffResult](report_toolkit_core.observable.mdx#diffresult)
- [InspectOptions](report_toolkit_core.observable.mdx#inspectoptions)
- [RTKPlugin](report_toolkit_core.observable.mdx#rtkplugin)
- [ToReportFromObjectOptions](report_toolkit_core.observable.mdx#toreportfromobjectoptions)
- [TransformOptions](report_toolkit_core.observable.mdx#transformoptions)
- [TransformerBlueprint](report_toolkit_core.observable.mdx#transformerblueprint)

### Functions

- [deregisterPlugins](report_toolkit_core.observable.mdx#deregisterplugins)
- [diff](report_toolkit_core.observable.mdx#diff)
- [fromTransformerChain](report_toolkit_core.observable.mdx#fromtransformerchain)
- [inspect](report_toolkit_core.observable.mdx#inspect)
- [isPluginRegistered](report_toolkit_core.observable.mdx#ispluginregistered)
- [loadConfig](report_toolkit_core.observable.mdx#loadconfig)
- [registeredRuleDefinitions](report_toolkit_core.observable.mdx#registeredruledefinitions)
- [toReportFromObject](report_toolkit_core.observable.mdx#toreportfromobject)
- [transform](report_toolkit_core.observable.mdx#transform)
- [use](report_toolkit_core.observable.mdx#use)

## Type aliases

### Config

Ƭ **Config**: *any*

A "normalized" configuration object.

___

### DiffOptions

Ƭ **DiffOptions**: *object*

Options for [diff](report_toolkit_core.observable.mdx#diff).

#### Type declaration:

* **excludeProperties**: *string[]*

* **includeAll**: *boolean*

* **includeProperties**: *string[]*

* **showSecretsUnsafe**: *boolean*

___

### DiffResult

Ƭ **DiffResult**: *object*

A single difference between two reports.  Emitted from [diff](report_toolkit_core.observable.mdx#diff).

#### Type declaration:

* **oldValue**: *string | number | boolean*

* **op**: *"replace" | "add" | "remove"*

* **path**: *string*

* **value**: *string | number | boolean*

___

### InspectOptions

Ƭ **InspectOptions**: *object*

Options for [inspect](report_toolkit_core.observable.mdx#inspect).

#### Type declaration:

* **ruleConfig**: *any*

* **severity**: *string*

* **showSecretsUnsafe**: *boolean*

* **sort**: *boolean*

* **sortDirection**: *"desc" | "asc"*

* **sortField**: *string*

___

### RTKPlugin

Ƭ **RTKPlugin**: *object*

Represents a "plugin".  As of this writing, plugins may only contain rule definitions for [inspect](report_toolkit_core.observable.mdx#inspect); it would make sense to add support for transformers, as well.

#### Type declaration:

* **rules**: *object[]*

___

### ToReportFromObjectOptions

Ƭ **ToReportFromObjectOptions**: *object*

Options for [toReportFromObject](report_toolkit_core.observable.mdx#toreportfromobject).

#### Type declaration:

* **showSecretsUnsafe**: *boolean*

___

### TransformOptions

Ƭ **TransformOptions**: *object*

Options for [transform](report_toolkit_core.observable.mdx#transform).

#### Type declaration:

* **beginWith**: *string*

* **defaultTransformer**: *string*

* **defaultTransformerConfig**: *any*

* **endWith**: *string*

___

### TransformerBlueprint

Ƭ **TransformerBlueprint**: *object*

A pairing of a transformer ID and a configuration of that transformer, to be
ingested by [transform](report_toolkit_core.observable.mdx#transform).

#### Type declaration:

* **config**: *any*

* **id**: *string*

## Functions

### deregisterPlugins

▸ **deregisterPlugins**(): *boolean*

De-register ("unload") all plugins.

Example:

```js
const {deregisterPlugins} = require('@report-toolkit/core').observable;

console.log(deregisterPlugins()); // `true` or `false`, depending.
```

**Returns:** *boolean*

`true` if plugins were cleared; `false` if none registered

___

### diff

▸ **diff**(`report1`: [DiagnosticReport](../interfaces/common_diagnostic_report_d_.diagnosticreport.mdx) | [Report](../classes/report_toolkit_common.report.report.mdx) | Observable‹[DiagnosticReport](../interfaces/common_diagnostic_report_d_.diagnosticreport.mdx) | [Report](../classes/report_toolkit_common.report.report.mdx)›, `report2`: [DiagnosticReport](../interfaces/common_diagnostic_report_d_.diagnosticreport.mdx) | [Report](../classes/report_toolkit_common.report.report.mdx) | Observable‹[DiagnosticReport](../interfaces/common_diagnostic_report_d_.diagnosticreport.mdx) | [Report](../classes/report_toolkit_common.report.report.mdx)›, `opts?`: Partial‹[DiffOptions](report_toolkit_core.observable.mdx#diffoptions)›): *Observable‹[DiffResult](report_toolkit_core.observable.mdx#diffresult)›*

Returns the difference between two reports.

Example:

```js
const {diff} = require('@report-toolkit/core').observable;

const report1 = process.report.getReport();
const report2 = process.report.getReport();

diff(report1, report2, {
  filterProperties: ['header', 'javascriptStack', 'nativeStack'],
  showSecretsUnsafe: false
}).subscribe(({op, path, newValue, oldValue}) => {
  console.log(`[${op}] <${path}> ${oldValue} => ${newValue}`);
})
```

**`todo`** support JSON reports

**Parameters:**

Name | Type | Description |
------ | ------ | ------ |
`report1` | [DiagnosticReport](../interfaces/common_diagnostic_report_d_.diagnosticreport.mdx) &#124; [Report](../classes/report_toolkit_common.report.report.mdx) &#124; Observable‹[DiagnosticReport](../interfaces/common_diagnostic_report_d_.diagnosticreport.mdx) &#124; [Report](../classes/report_toolkit_common.report.report.mdx)› | First report to diff |
`report2` | [DiagnosticReport](../interfaces/common_diagnostic_report_d_.diagnosticreport.mdx) &#124; [Report](../classes/report_toolkit_common.report.report.mdx) &#124; Observable‹[DiagnosticReport](../interfaces/common_diagnostic_report_d_.diagnosticreport.mdx) &#124; [Report](../classes/report_toolkit_common.report.report.mdx)› | Second report to diff |
`opts?` | Partial‹[DiffOptions](report_toolkit_core.observable.mdx#diffoptions)› | - |

**Returns:** *Observable‹[DiffResult](report_toolkit_core.observable.mdx#diffresult)›*

Results, one per difference

___

### fromTransformerChain

▸ **fromTransformerChain**(`transformerIds`: string | string[], `config?`: Partial‹any›): *Observable‹[TransformerBlueprint](report_toolkit_core.observable.mdx#transformerblueprint)›*

Given a list of transformer IDs, create an `Observable` which emits [TransformerBlueprint](report_toolkit_core.observable.mdx#transformerblueprint) objects. Output should be piped to [transform](report_toolkit_core.observable.mdx#transform).

Example:

```js
const {fromTransformerChain} = require('@report-toolkit/core').observable;

fromTransformerChain(['filter', 'csv'], {
  transformers: {
    filter: {include: 'header'},
    csv: {flatten: true}
  }
}); // pipe to transform()
```

**Parameters:**

Name | Type | Description |
------ | ------ | ------ |
`transformerIds` | string &#124; string[] | List of Transformer IDs |
`config?` | Partial‹any› | - |

**Returns:** *Observable‹[TransformerBlueprint](report_toolkit_core.observable.mdx#transformerblueprint)›*

___

### inspect

▸ **inspect**(`reports`: [DiagnosticReport](../interfaces/common_diagnostic_report_d_.diagnosticreport.mdx) | [Report](../classes/report_toolkit_common.report.report.mdx) | Observable‹[DiagnosticReport](../interfaces/common_diagnostic_report_d_.diagnosticreport.mdx) | [Report](../classes/report_toolkit_common.report.report.mdx)›, `opts?`: Partial‹[InspectOptions](report_toolkit_core.observable.mdx#inspectoptions)›): *Observable‹[Message](../classes/report_toolkit_inspector.message.message.mdx)›*

Inspect one or more reports, running rules against each.  Resolves with an array of zero or more [Messages](../classes/report_toolkit_inspector.message.message.mdx).

Example:

```js
const {inspect} = require('@report-toolkit/core').observable

const report = process.report.getReport();
inspect(report, {
  severity: 'info',
  sort: true,
  sortDirection: 'asc',
  sortField: 'header.dumpEventTimestamp',
  showSecretsUnsafe: false,
  ruleConfig: {
    'long-timeout': {
      timeout: '2s'
    }
  }
}).subscribe({message, filename} => {
  console.log(`${filename}: ${message}`);
});
```

**Parameters:**

Name | Type | Description |
------ | ------ | ------ |
`reports` | [DiagnosticReport](../interfaces/common_diagnostic_report_d_.diagnosticreport.mdx) &#124; [Report](../classes/report_toolkit_common.report.report.mdx) &#124; Observable‹[DiagnosticReport](../interfaces/common_diagnostic_report_d_.diagnosticreport.mdx) &#124; [Report](../classes/report_toolkit_common.report.report.mdx)› | One or more Reports |
`opts?` | Partial‹[InspectOptions](report_toolkit_core.observable.mdx#inspectoptions)› | - |

**Returns:** *Observable‹[Message](../classes/report_toolkit_inspector.message.message.mdx)›*

___

### isPluginRegistered

▸ **isPluginRegistered**(`pluginId`: string): *boolean*

Returns `true` if plugin with id `pluginId` has already been registered.

```js
const {isPluginRegistered} = require('@report-toolkit/core').observable;

console.log(isPluginRegistered('my-plugin')); // `true` or `false`, depending.
```

**Parameters:**

Name | Type | Description |
------ | ------ | ------ |
`pluginId` | string | A unique [module ID](https://nodejs.org/api/modules.html#modules_module_id)  |

**Returns:** *boolean*

___

### loadConfig

▸ **loadConfig**(`config`: any): *Observable‹any›*

Emits normalized config objects from raw config objects. Only a single input config should be necessary.

Example:

```js
const {loadConfig} = require('@report-toolkit/core').observable;

// or require('./path/to/.rtkrc.js')
const rawConfig = [
  'report-toolkit:recommended',
  {
    rules: {
      'long-timeout': {
        timeout: '2s'
      }
    }
  }
];

loadConfig(rawConfig).subscribe(normalizedConfig => {
  // `normalizedConfig` contains contents of "recommended" settings,
  // with our override of custom rule config
});
```

**`todo`** ALWAYS load builtin plugin(s)

**`todo`** Document config shape

**Parameters:**

Name | Type | Description |
------ | ------ | ------ |
`config` | any | Raw config object |

**Returns:** *Observable‹any›*

Normalized config object(s)

___

### registeredRuleDefinitions

▸ **registeredRuleDefinitions**(): *object[]*

Get a list of rule definitions contained within registered plugins.

Example:

```js
const {registeredRuleDefinitions} = require('@report-toolkit/core').observable;

registeredRuleDefinitions().forEach(ruleDef => {
  console.log(ruleDef.meta.id);
})
```

**Returns:** *object[]*

___

### toReportFromObject

▸ **toReportFromObject**(`opts?`: Partial‹[ToReportFromObjectOptions](report_toolkit_core.observable.mdx#toreportfromobjectoptions)›): *OperatorFunction‹any, Readonly‹[Report](../classes/report_toolkit_common.report.report.mdx)››*

Creates a target `Observable` of [Report](../classes/report_toolkit_common.report.report.mdx) objects from a source `Observable` of plain objects (usually parsed from a JSON report).

Example:

```js
const {toReportFromObject} = require('@report-toolkit/core').observable;

const json = fs.readFileSync('./report-xxxxx.json');
toReportFromObject(json, {
  showSecretsUnsafe: false
}).subscribe(report => {
 // `Report` instance with secrets redacted
});
```

**Parameters:**

Name | Type |
------ | ------ |
`opts?` | Partial‹[ToReportFromObjectOptions](report_toolkit_core.observable.mdx#toreportfromobjectoptions)› |

**Returns:** *OperatorFunction‹any, Readonly‹[Report](../classes/report_toolkit_common.report.report.mdx)››*

___

### transform

▸ **transform**(`source`: Observable‹any›, `opts?`: Partial‹[TransformOptions](report_toolkit_core.observable.mdx#transformoptions)›): *OperatorFunction‹[TransformerBlueprint](report_toolkit_core.observable.mdx#transformerblueprint), any›*

Run `source` through chain of one or more transformers.  Pipe [fromTransformerChain](report_toolkit_core.observable.mdx#fromtransformerchain) into this.
Performs validation before piping.
While most other functions here will automatically convert a raw report into a `Report` instance for further processing, this one does not (since transformers don't necessarily accept them).  You'll need to do this manually, as seen in the below example.
If the final transformer does not output the desired `endType`, the `defaultTransformer` will be appended to the chain; otherwise it is ignored.

Example:

```js
const {fromTransformerChain, transform, toReportFromObject} = require('@report-toolkit/core').observable;

const report$ = toReportFromObject(process.report.getReport());
fromTransformerChain(['filter', 'csv'], {
  transformers: {
    filter: {include: 'header'},
    csv: {flatten: true}
  }
}).pipe(transform(report$)).subscribe(line => {
  console.log(line);
});
```

**Parameters:**

Name | Type | Description |
------ | ------ | ------ |
`source` | Observable‹any› | Source data to transform.  Objects, [Reports](../classes/report_toolkit_common.report.report.mdx), etc. |
`opts?` | Partial‹[TransformOptions](report_toolkit_core.observable.mdx#transformoptions)› | - |

**Returns:** *OperatorFunction‹[TransformerBlueprint](report_toolkit_core.observable.mdx#transformerblueprint), any›*

Result of running `source` through the transformer chains.

___

### use

▸ **use**(`pluginId`: string): *Observable‹[RTKPlugin](report_toolkit_core.observable.mdx#rtkplugin)›*

Register & enable a plugin.

Example:

```js
const {use} = require('@report-toolkit/core').observable;

use('some-plugin-in-node_modules').subscribe();

```

**Parameters:**

Name | Type | Description |
------ | ------ | ------ |
`pluginId` | string | ID of plugin to register; a resolvable path to a module |

**Returns:** *Observable‹[RTKPlugin](report_toolkit_core.observable.mdx#rtkplugin)›*

A plugin instance, but YAGNI.

